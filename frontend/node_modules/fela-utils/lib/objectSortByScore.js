'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = objectSortByScore;

var _arrayReduce = require('fast-loops/lib/arrayReduce');

var _arrayReduce2 = _interopRequireDefault(_arrayReduce);

var _objectReduce = require('fast-loops/lib/objectReduce');

var _objectReduce2 = _interopRequireDefault(_objectReduce);

var _insertAtIndex = require('./insertAtIndex');

var _insertAtIndex2 = _interopRequireDefault(_insertAtIndex);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

// TODO: we can further improve this one
function objectSortByScore(obj, getScore) {
  var sortedKeys = (0, _objectReduce2.default)(obj, function (resultSortedKeys, value, key) {
    var index = resultSortedKeys.findIndex(function (el) {
      return getScore(obj[el], el) > getScore(value, key);
    });

    if (index !== -1) {
      return (0, _insertAtIndex2.default)(resultSortedKeys, key, index);
    }

    return [].concat(_toConsumableArray(resultSortedKeys), [key]);
  }, []);

  return (0, _arrayReduce2.default)(sortedKeys, function (sortedObj, key) {
    sortedObj[key] = obj[key];
    return sortedObj;
  }, {});
}